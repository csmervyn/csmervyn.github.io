<!doctype html><html lang=zh-cn><head><title>Spring Boot ä¸­å¦‚ä½•è®¾ç½® serializer çš„ TimeZone Â· å¢¨å®¢äººç”Ÿ
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Mervyn"><meta name=description content="
  1 èƒŒæ™¯
  
    
    é“¾æ¥åˆ°æ ‡é¢˜
  

åœ¨ä¸€ä¸ªåŸºäº Spring Boot çš„æœåŠ¡ä¸­ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ª Restful æ¥å£ Aã€‚è¯¥æ¥å£çš„è¿”å›å€¼ç±»å‹ä¸­åŒ…å«ä¸€ä¸ª ZonedDateTime ç±»å‹çš„å­—æ®µ createdDateTimeã€‚Prod ä»£ç ä¾§æœŸæœ›è¿”å›æ—¶åŒºä¸º Australia/Sydneyï¼ˆUTC+10/UTC+10ï¼‰çš„æ—¶é—´ï¼Œå¹¶å¸¦æœ‰æ—¶åŒºä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œ2024-11-03T08:23:24+11:00ã€‚å¹¶ä¸”æµ‹è¯•ä¾§ä»£ç ä¹Ÿæ˜¯æŒ‰ç…§æœŸæœ›è¿›è¡Œäº†æµ‹è¯•ï¼Œæµ‹è¯•åœ¨ Pipeline å’Œæ¾³æ´² Dev çš„æœ¬åœ°ç”µè„‘ä¸­å¯ä»¥é€šè¿‡ã€‚æµ‹è¯•ç¤ºä¾‹å¦‚ä»£ç 1æ‰€ç¤ºã€‚ä½†æ˜¯è¯¥ä»£ç ç¡®ä¸èƒ½åœ¨ä¸­å›½ Dev çš„æœ¬åœ°ç”µè„‘ä¸Šå·¥ä½œã€‚"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring Boot ä¸­å¦‚ä½•è®¾ç½® serializer çš„ TimeZone"><meta name=twitter:description content="1 èƒŒæ™¯ é“¾æ¥åˆ°æ ‡é¢˜ åœ¨ä¸€ä¸ªåŸºäº Spring Boot çš„æœåŠ¡ä¸­ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ª Restful æ¥å£ Aã€‚è¯¥æ¥å£çš„è¿”å›å€¼ç±»å‹ä¸­åŒ…å«ä¸€ä¸ª ZonedDateTime ç±»å‹çš„å­—æ®µ createdDateTimeã€‚Prod ä»£ç ä¾§æœŸæœ›è¿”å›æ—¶åŒºä¸º Australia/Sydneyï¼ˆUTC+10/UTC+10ï¼‰çš„æ—¶é—´ï¼Œå¹¶å¸¦æœ‰æ—¶åŒºä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œ2024-11-03T08:23:24+11:00ã€‚å¹¶ä¸”æµ‹è¯•ä¾§ä»£ç ä¹Ÿæ˜¯æŒ‰ç…§æœŸæœ›è¿›è¡Œäº†æµ‹è¯•ï¼Œæµ‹è¯•åœ¨ Pipeline å’Œæ¾³æ´² Dev çš„æœ¬åœ°ç”µè„‘ä¸­å¯ä»¥é€šè¿‡ã€‚æµ‹è¯•ç¤ºä¾‹å¦‚ä»£ç 1æ‰€ç¤ºã€‚ä½†æ˜¯è¯¥ä»£ç ç¡®ä¸èƒ½åœ¨ä¸­å›½ Dev çš„æœ¬åœ°ç”µè„‘ä¸Šå·¥ä½œã€‚"><meta property="og:url" content="http://example.org/posts/how_to_configure_timezone_for_serializer_in_spring_boot/"><meta property="og:site_name" content="å¢¨å®¢äººç”Ÿ"><meta property="og:title" content="Spring Boot ä¸­å¦‚ä½•è®¾ç½® serializer çš„ TimeZone"><meta property="og:description" content="1 èƒŒæ™¯ é“¾æ¥åˆ°æ ‡é¢˜ åœ¨ä¸€ä¸ªåŸºäº Spring Boot çš„æœåŠ¡ä¸­ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ª Restful æ¥å£ Aã€‚è¯¥æ¥å£çš„è¿”å›å€¼ç±»å‹ä¸­åŒ…å«ä¸€ä¸ª ZonedDateTime ç±»å‹çš„å­—æ®µ createdDateTimeã€‚Prod ä»£ç ä¾§æœŸæœ›è¿”å›æ—¶åŒºä¸º Australia/Sydneyï¼ˆUTC+10/UTC+10ï¼‰çš„æ—¶é—´ï¼Œå¹¶å¸¦æœ‰æ—¶åŒºä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œ2024-11-03T08:23:24+11:00ã€‚å¹¶ä¸”æµ‹è¯•ä¾§ä»£ç ä¹Ÿæ˜¯æŒ‰ç…§æœŸæœ›è¿›è¡Œäº†æµ‹è¯•ï¼Œæµ‹è¯•åœ¨ Pipeline å’Œæ¾³æ´² Dev çš„æœ¬åœ°ç”µè„‘ä¸­å¯ä»¥é€šè¿‡ã€‚æµ‹è¯•ç¤ºä¾‹å¦‚ä»£ç 1æ‰€ç¤ºã€‚ä½†æ˜¯è¯¥ä»£ç ç¡®ä¸èƒ½åœ¨ä¸­å›½ Dev çš„æœ¬åœ°ç”µè„‘ä¸Šå·¥ä½œã€‚"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-24T22:03:04+08:00"><meta property="article:modified_time" content="2024-11-24T22:03:04+08:00"><meta property="article:tag" content="Serializer"><meta property="article:tag" content="TimeZone"><meta property="article:tag" content="Spring Boot"><link rel=canonical href=http://example.org/posts/how_to_configure_timezone_for_serializer_in_spring_boot/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.aa5ef26fa979d6793724ae2dbd71efa94fd16cb1c5c7db3b6651f21f9892a5fd.css integrity="sha256-ql7yb6l51nk3JK4tvXHvqU/RbLHFx9s7ZlHyH5iSpf0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://example.org/>å¢¨å®¢äººç”Ÿ
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/life/>ç”Ÿæ´»</a></li><li class=navigation-item><a class=navigation-link href=/posts/>åšå®¢</a></li><li class=navigation-item><a class=navigation-link href=/about-me>å…³äºæˆ‘</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://example.org/posts/how_to_configure_timezone_for_serializer_in_spring_boot/>Spring Boot ä¸­å¦‚ä½•è®¾ç½® serializer çš„ TimeZone</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-11-24T22:03:04+08:00>November 24, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
é˜…è¯»æ—¶é—´ï¼š9 åˆ†é’Ÿ
</span><span class=post-word-count>| ğŸ‰ 4353 å­—</span></div><div class=authors><i class="fa-solid fa-user" aria-hidden=true></i>
<a href=/authors/mervyn/>Mervyn</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/serializer/>Serializer</a>
</span><span class=separator>â€¢</span>
<span class=tag><a href=/tags/timezone/>TimeZone</a>
</span><span class=separator>â€¢</span>
<span class=tag><a href=/tags/spring-boot/>Spring Boot</a></span></div></div></header><div class=post-content><h2 id=1-èƒŒæ™¯>1 èƒŒæ™¯
<a class=heading-link href=#1-%e8%83%8c%e6%99%af><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>åœ¨ä¸€ä¸ªåŸºäº Spring Boot çš„æœåŠ¡ä¸­ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ª Restful æ¥å£ Aã€‚è¯¥æ¥å£çš„è¿”å›å€¼ç±»å‹ä¸­åŒ…å«ä¸€ä¸ª ZonedDateTime ç±»å‹çš„å­—æ®µ createdDateTimeã€‚Prod ä»£ç ä¾§æœŸæœ›è¿”å›æ—¶åŒºä¸º Australia/Sydneyï¼ˆUTC+10/UTC+10ï¼‰çš„æ—¶é—´ï¼Œå¹¶å¸¦æœ‰æ—¶åŒºä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œ2024-11-03T08:23:24+11:00ã€‚å¹¶ä¸”æµ‹è¯•ä¾§ä»£ç ä¹Ÿæ˜¯æŒ‰ç…§æœŸæœ›è¿›è¡Œäº†æµ‹è¯•ï¼Œæµ‹è¯•åœ¨ Pipeline å’Œæ¾³æ´² Dev çš„æœ¬åœ°ç”µè„‘ä¸­å¯ä»¥é€šè¿‡ã€‚æµ‹è¯•ç¤ºä¾‹å¦‚ä»£ç 1æ‰€ç¤ºã€‚ä½†æ˜¯è¯¥ä»£ç ç¡®ä¸èƒ½åœ¨ä¸­å›½ Dev çš„æœ¬åœ°ç”µè„‘ä¸Šå·¥ä½œã€‚</p><p>åœ¨åŒæ ·çš„æµ‹è¯•æ•°æ®æƒ…å†µä¸‹ï¼ŒA æ¥å£çš„å“åº”ä¸­ createdDateTime å­—æ®µçš„å€¼ï¼Œå› ä»£ç è¿è¡Œæ‰€åœ¨æ—¶åŒºçš„ä¸åŒè€Œä¸åŒã€‚å…·ä½“æ¥è¯´ï¼Œå‡å¦‚ ZonedDateTime ç±»å‹çš„ createdDateTime å­—æ®µåœ¨ Java å€¼ä¸º 2024-11-03T08:23:24+11:00[Australia/Sydney]ã€‚å¦‚æœåœ¨æ¾³æ´²è¿è¡Œæµ‹è¯•ä»£ç ï¼ŒA æ¥å£çš„å“åº”ä¸º <code>{"createdDateTime": 2024-11-03T08:23:24+11:00}</code>ã€‚ä½†æ˜¯å¦‚æœåœ¨ä¸­å›½è¿è¡Œæµ‹è¯•ä»£ç ï¼ŒA æ¥å£çš„å“åº”ä¸º <code>{"createdDateTime": 2024-11-03T05:23:24+08:00}</code>ã€‚é€šè¿‡å¯¹æ¯”æ¾³æ´²å’Œä¸­å›½çš„ A æ¥å£çš„å“åº”å¯ä»¥å‘ç° createdDateTime å­—æ®µå€¼ï¼Œå®é™…ä»£è¡¨åŒä¸€ä¸ªæ—¶é—´ä½†ä»…æ˜¯æ—¶åŒºä¸ä¸€æ ·ã€‚ä¸€ä¸ªæ—¶é—´æ˜¯ UTC+11ï¼ˆAustralia/Sydneyï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯UTC+8ï¼ˆAsia/Shanghaiï¼‰ã€‚ä½†æ˜¯ä»ç”Ÿäº§ä»£ç å’Œæµ‹è¯•ä»£ç çš„è§’åº¦ä¸Šæ¥è®²ï¼Œå…¶æœŸæœ› A æ¥å£çš„å“åº”ä¸­çš„ createdDateTime ä¸€ç›´è¿”å›é¢å‘ UTC+10/UTC+11 çš„æ—¶é—´ã€‚æµ‹è¯•ä»£ç ç¤ºä¾‹ï¼Œå¦‚ä»£ç æ¸…å• 1 æ‰€ç¤ºã€‚
ä»£ç æ¸…å• 1: æµ‹è¯• A æ¥å£çš„ä»£ç ç¤ºä¾‹ UserControllerTest.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>void</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>theTimeZoneOfCreatedDateTimeShouldBeAustraliaSydney</span>()<span style=color:#6e7681> </span><span style=color:#ff7b72>throws</span><span style=color:#6e7681> </span>Exception<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>mockMvc.perform(get(<span style=color:#a5d6ff>&#34;/users&#34;</span>))<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                </span>.andExpect(status().isOk())<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                </span>.andExpect(jsonPath(<span style=color:#a5d6ff>&#34;$[0].createdDateTime&#34;</span>,<span style=color:#6e7681> </span>is(notNullValue())))<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                </span>.andExpect(jsonPath(<span style=color:#a5d6ff>&#34;$[0].createdDateTime&#34;</span>,<span style=color:#6e7681> </span>anyOf(containsString(<span style=color:#a5d6ff>&#34;+11:00&#34;</span>),<span style=color:#6e7681> </span>containsString(<span style=color:#a5d6ff>&#34;+10:00&#34;</span>))));<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=2-é—®é¢˜çš„åˆ†æ>2 é—®é¢˜çš„åˆ†æ
<a class=heading-link href=#2-%e9%97%ae%e9%a2%98%e7%9a%84%e5%88%86%e6%9e%90><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>é¦–å…ˆå¯¹é—®é¢˜çš„åˆæ­¥å®šä½æ˜¯ï¼Œè¿™æ˜¯å› ä¸ºå¯¹è±¡åºåˆ—åŒ–æ–¹é¢çš„é—®é¢˜ã€‚é¦–å…ˆæˆ‘ä»¬äº†è§£åˆ° Spring Boot ä½¿ç”¨ä¸åŒçš„ HttpMessageConverter æ¥å¤„ç†ä¸åŒçš„ MediaTypes çš„å“åº”ã€‚é»˜è®¤ Spring Boot é€šè¿‡ Jackson åº“ï¼Œå¹¶ä½¿ç”¨ MappingJackson2HttpMessageConverter å¤„ç† MediaType ä¸º <code>application/json</code> æˆ– <code>application/*+json</code> çš„å“åº”ã€‚MappingJackson2HttpMessageConverter é’ˆå¯¹ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¼šåˆ©ç”¨ jackson-databind åº“çš„æˆ–è‡ªå®šä¹‰çš„ Serializer å’Œ Deserializerï¼Œå¯¹æ¥å£çš„è¿”å›ç»“æœæˆ–è¯·æ±‚å‚æ•°è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬é‡åˆ°æ˜¯å…³äºåºåˆ—åŒ–çš„é—®é¢˜ï¼Œå› æ­¤åœ¨è¿™é‡Œç›®å‰æˆ‘ä»¬ä»…ä»…å…³æ³¨åºåˆ—åŒ–ã€‚ä¾‹å¦‚ ZonedDateTime ç±»å‹çš„æ•°æ®ï¼ŒMappingJackson2HttpMessageConverter ä¾¿æ˜¯é€šè¿‡ jackson-databind åº“ä¸­çš„ ObjectMapper å’Œè¯¥åº“ä¸­å†…å»ºçš„ ZonedDateTimeSerializerï¼Œå®Œæˆå¯¹ ZonedDateTime ç±»å‹çš„å¯¹è±¡çš„åºåˆ—åŒ–ã€‚åœ¨ç»§ç»­åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ Spring Boot ä¸­å¦‚ä½•æ„å»º MappingJackson2HttpMessageConverter å’Œ ObjectMapper å¯¹è±¡çš„ã€‚</p><h3 id=21-spring-boot-ä¸­å¦‚ä½•è‡ªåŠ¨è£…é…-mappingjackson2httpmessageconverter>2.1 Spring Boot ä¸­å¦‚ä½•è‡ªåŠ¨è£…é… MappingJackson2HttpMessageConverterï¼Ÿ
<a class=heading-link href=#21-spring-boot-%e4%b8%ad%e5%a6%82%e4%bd%95%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d-mappingjackson2httpmessageconverter><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>å¦‚ä»£ç æ¸…å•2æ‰€ç¤ºï¼Œåœ¨ JacksonHttpMessageConvertersConfiguration ç±» Spring Boot ä½¿ç”¨ ObjectMapper æ¥æ„å»º MappingJackson2HttpMessageConverter å¯¹è±¡ã€‚é‚£ Spring Boot ä¸­å¦‚ä½•è£…é… ObjectMapper å¯¹è±¡å‘¢ï¼Ÿ</p><p>ä»£ç æ¸…å• 2: Spring Boot ä¸­è‡ªåŠ¨è£…é… MappingJackson2HttpMessageConverter çš„ä»£ç ç‰‡æ®µ JacksonHttpMessageConvertersConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Configuration</span>(proxyBeanMethods<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>false</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnClass</span>(ObjectMapper.class)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnBean</span>(ObjectMapper.class)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnProperty</span>(name<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>HttpMessageConvertersAutoConfiguration.PREFERRED_MAPPER_PROPERTY,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>havingValue<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;jackson&#34;</span>,<span style=color:#6e7681> </span>matchIfMissing<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>true</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>static</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>MappingJackson2HttpMessageConverterConfiguration</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnMissingBean</span>(value<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>MappingJackson2HttpMessageConverter.class,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>ignoredType<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                    </span><span style=color:#a5d6ff>&#34;org.springframework.hateoas.server.mvc.TypeConstrainedMappingJackson2HttpMessageConverter&#34;</span>,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                    </span><span style=color:#a5d6ff>&#34;org.springframework.data.rest.webmvc.alps.AlpsJsonHttpMessageConverter&#34;</span><span style=color:#6e7681> </span>})<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>MappingJackson2HttpMessageConverter<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>mappingJackson2HttpMessageConverter</span>(ObjectMapper<span style=color:#6e7681> </span>objectMapper)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span><span style=color:#ff7b72>new</span><span style=color:#6e7681> </span>MappingJackson2HttpMessageConverter(objectMapper);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=22-spring-boot-ä¸­å¦‚ä½•è‡ªåŠ¨è£…é…-objectmapper>2.2 Spring Boot ä¸­å¦‚ä½•è‡ªåŠ¨è£…é… ObjectMapperï¼Ÿ
<a class=heading-link href=#22-spring-boot-%e4%b8%ad%e5%a6%82%e4%bd%95%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d-objectmapper><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>å¦‚ä»£ç æ¸…å•3æ‰€ç¤ºï¼Œåœ¨ JacksonAutoConfiguration ä¸­ï¼ŒSpring Boot ä¸­ä½¿ç”¨ Jackson2ObjectMapperBuilder æ¥è‡ªåŠ¨è£…é… ObjectMapper å¯¹è±¡ã€‚Jackson2ObjectMapperBuilder çš„ build çš„æ–¹æ³•ä¸­ä¼šæ³¨å†Œä¸€äº›å¸¸ç”¨çš„ Module ä¾‹å¦‚ï¼ŒJdk8Moduleã€ParameterNamesModule å’Œ JavaTimeModule ä»¥åŠ KotlinModule ç­‰ã€‚é‚£ Spring Boot ä¸­å¦‚ä½•è£…é… Jackson2ObjectMapperBuilder å¯¹è±¡å‘¢ï¼Ÿ</p><p>ä»£ç æ¸…å• 3: Spring Boot ä¸­è‡ªåŠ¨è£…é… ObjectMapper çš„ä»£ç ç‰‡æ®µ JacksonAutoConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Configuration</span>(proxyBeanMethods<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>false</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnClass</span>(Jackson2ObjectMapperBuilder.class)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>static</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>JacksonObjectMapperConfiguration</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Primary</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnMissingBean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>ObjectMapper<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>jacksonObjectMapper</span>(Jackson2ObjectMapperBuilder<span style=color:#6e7681> </span>builder)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>builder.createXmlMapper(<span style=color:#79c0ff>false</span>).build();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=23-spring-boot-ä¸­å¦‚ä½•è‡ªåŠ¨è£…é…-jackson2objectmapperbuilder>2.3 Spring Boot ä¸­å¦‚ä½•è‡ªåŠ¨è£…é… Jackson2ObjectMapperBuilderï¼Ÿ
<a class=heading-link href=#23-spring-boot-%e4%b8%ad%e5%a6%82%e4%bd%95%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d-jackson2objectmapperbuilder><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>å¦‚ä»£ç æ¸…å•4æ‰€ç¤ºï¼Œåœ¨ JacksonAutoConfiguration ä¸­ï¼ŒSpring Boot ä¸­ä½¿ç”¨ List æ¥æ„å»º Jackson2ObjectMapperBuilder å¯¹è±¡ã€‚å¹¶ä½¿ç”¨ List å¯¹ Jackson2ObjectMapperBuilder å¯¹è±¡è¿›è¡Œè‡ªå®šä¹‰ã€‚Jackson2ObjectMapperBuilder ä¼šè°ƒç”¨æ‰€æœ‰ List çš„ customize æ–¹æ³•ï¼Œä»è€Œå¯¹ Jackson2ObjectMapperBuilder å¯¹è±¡è¿›è¡Œé…ç½®ã€‚é‚£ Spring Boot ä¸­å¦‚ä½•è£…é… Jackson2ObjectMapperBuilderCustomizer å¯¹è±¡å‘¢ï¼Ÿ
ä»£ç æ¸…å• 4: Spring Boot ä¸­è‡ªåŠ¨è£…é… Jackson2ObjectMapperBuilder çš„ä»£ç ç‰‡æ®µ JacksonAutoConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Configuration</span>(proxyBeanMethods<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>false</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnClass</span>(Jackson2ObjectMapperBuilder.class)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>static</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>JacksonObjectMapperBuilderConfiguration</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Scope</span>(<span style=color:#a5d6ff>&#34;prototype&#34;</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnMissingBean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>Jackson2ObjectMapperBuilder<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>jacksonObjectMapperBuilder</span>(ApplicationContext<span style=color:#6e7681> </span>applicationContext,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>Jackson2ObjectMapperBuilderCustomizer<span style=color:#ff7b72;font-weight:700>&gt;</span><span style=color:#6e7681> </span>customizers)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>Jackson2ObjectMapperBuilder<span style=color:#6e7681> </span>builder<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#ff7b72>new</span><span style=color:#6e7681> </span>Jackson2ObjectMapperBuilder();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>builder.applicationContext(applicationContext);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>customize(builder,<span style=color:#6e7681> </span>customizers);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>builder;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>private</span><span style=color:#6e7681> </span><span style=color:#ff7b72>void</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>customize</span>(Jackson2ObjectMapperBuilder<span style=color:#6e7681> </span>builder,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>List<span style=color:#ff7b72;font-weight:700>&lt;</span>Jackson2ObjectMapperBuilderCustomizer<span style=color:#ff7b72;font-weight:700>&gt;</span><span style=color:#6e7681> </span>customizers)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>for</span><span style=color:#6e7681> </span>(Jackson2ObjectMapperBuilderCustomizer<span style=color:#6e7681> </span>customizer<span style=color:#6e7681> </span>:<span style=color:#6e7681> </span>customizers)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>customizer.customize(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=24-spring-boot-ä¸­å¦‚ä½•è‡ªåŠ¨è£…é…-jackson2objectmapperbuildercustomizer>2.4 Spring Boot ä¸­å¦‚ä½•è‡ªåŠ¨è£…é… Jackson2ObjectMapperBuilderCustomizerï¼Ÿ
<a class=heading-link href=#24-spring-boot-%e4%b8%ad%e5%a6%82%e4%bd%95%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d-jackson2objectmapperbuildercustomizer><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>å¦‚ä»£ç æ¸…å•4æ‰€ç¤ºï¼Œåœ¨ JacksonAutoConfiguration ä¸­ï¼ŒSpring Boot å®ç°äº†ä¸€ä¸ª Jackson2ObjectMapperBuilderCustomizer æ¥å£çš„ StandardJackson2ObjectMapperBuilderCustomizerï¼Œå¹¶å‘å®¹å™¨ä¸­è¯¥ç±»å‹çš„å¯¹è±¡ã€‚åœ¨ StandardJackson2ObjectMapperBuilderCustomizer çš„ customize æ–¹æ³•ä¼šä»é…ç½®æ–‡ä»¶ä¸­è¯»å– jackson ç›¸å…³çš„å±æ€§æ¥é…ç½® Jackson2ObjectMapperBuilderã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„ Jackson2ObjectMapperBuilderCustomizer æ¥å£çš„å®ç°ç±»ï¼Œä»è€Œç”¨æ¥é…ç½® Jackson2ObjectMapperBuilderã€‚</p><p>ä»£ç æ¸…å• 5: Spring Boot ä¸­è‡ªåŠ¨è£…é… Jackson2ObjectMapperBuilderCustomizer çš„ä»£ç ç‰‡æ®µ JacksonAutoConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Configuration</span>(proxyBeanMethods<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>false</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@ConditionalOnClass</span>(Jackson2ObjectMapperBuilder.class)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#d2a8ff;font-weight:700>@EnableConfigurationProperties</span>(JacksonProperties.class)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>static</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>Jackson2ObjectMapperBuilderCustomizerConfiguration</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>StandardJackson2ObjectMapperBuilderCustomizer<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>standardJacksonObjectMapperBuilderCustomizer</span>(<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>JacksonProperties<span style=color:#6e7681> </span>jacksonProperties,<span style=color:#6e7681> </span>ObjectProvider<span style=color:#ff7b72;font-weight:700>&lt;</span>Module<span style=color:#ff7b72;font-weight:700>&gt;</span><span style=color:#6e7681> </span>modules)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span><span style=color:#ff7b72>new</span><span style=color:#6e7681> </span>StandardJackson2ObjectMapperBuilderCustomizer(jacksonProperties,<span style=color:#6e7681> </span>modules.stream().toList());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>static</span><span style=color:#6e7681> </span><span style=color:#ff7b72>final</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>StandardJackson2ObjectMapperBuilderCustomizer</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#ff7b72>implements</span><span style=color:#6e7681> </span>Jackson2ObjectMapperBuilderCustomizer,<span style=color:#6e7681> </span>Ordered<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>private</span><span style=color:#6e7681> </span><span style=color:#ff7b72>final</span><span style=color:#6e7681> </span>JacksonProperties<span style=color:#6e7681> </span>jacksonProperties;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>private</span><span style=color:#6e7681> </span><span style=color:#ff7b72>final</span><span style=color:#6e7681> </span>Collection<span style=color:#ff7b72;font-weight:700>&lt;</span>Module<span style=color:#ff7b72;font-weight:700>&gt;</span><span style=color:#6e7681> </span>modules;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>StandardJackson2ObjectMapperBuilderCustomizer(JacksonProperties<span style=color:#6e7681> </span>jacksonProperties,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                                                      </span>Collection<span style=color:#ff7b72;font-weight:700>&lt;</span>Module<span style=color:#ff7b72;font-weight:700>&gt;</span><span style=color:#6e7681> </span>modules)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#ff7b72>this</span>.jacksonProperties<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>jacksonProperties;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#ff7b72>this</span>.modules<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>modules;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#d2a8ff;font-weight:700>@Override</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>int</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>getOrder</span>()<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>0;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#d2a8ff;font-weight:700>@Override</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>void</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>customize</span>(Jackson2ObjectMapperBuilder<span style=color:#6e7681> </span>builder)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(<span style=color:#ff7b72>this</span>.jacksonProperties.getDefaultPropertyInclusion()<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                </span>builder.serializationInclusion(<span style=color:#ff7b72>this</span>.jacksonProperties.getDefaultPropertyInclusion());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(<span style=color:#ff7b72>this</span>.jacksonProperties.getTimeZone()<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                </span>builder.timeZone(<span style=color:#ff7b72>this</span>.jacksonProperties.getTimeZone());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span>FEATURE_DEFAULTS);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureVisibility(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getVisibility());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getDeserialization());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getSerialization());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getMapper());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getParser());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getGenerator());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getDatatype().getEnum());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureFeatures(builder,<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.jacksonProperties.getDatatype().getJsonNode());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureDateFormat(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configurePropertyNamingStrategy(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureModules(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureLocale(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureDefaultLeniency(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>configureConstructorDetector(builder);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic>// .....</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=25-zoneddatetimeserializer-å¦‚ä½•å¯¹-zoneddatetime-å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–>2.5 ZonedDateTimeSerializer å¦‚ä½•å¯¹ ZonedDateTime å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ã€‚
<a class=heading-link href=#25-zoneddatetimeserializer-%e5%a6%82%e4%bd%95%e5%af%b9-zoneddatetime-%e5%af%b9%e8%b1%a1%e8%bf%9b%e8%a1%8c%e5%ba%8f%e5%88%97%e5%8c%96><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>é€šè¿‡ 2.1 è‡³ 2.4 èŠ‚çš„ç®€è¿°ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ Spring Boot ä¸­å¦‚ä½•æ„å»º MappingJackson2HttpMessageConverter å’Œ ObjectMapper å¯¹è±¡ã€‚ç´§æ¥ç€ï¼Œæˆ‘ä»¬äº†è§£ ZonedDateTimeSerializer å¦‚ä½•å¯¹ ZonedDateTime å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ã€‚ZonedDateTimeSerializer ä¼šä½¿ç”¨å…¶çˆ¶ç±» InstantSerializerBase çš„ formatValue æ–¹æ³•å¯¹ ZonedDateTime å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–å’Œæ ¼å¼åŒ–ï¼Œå¦‚ä»£ç æ¸…å•6æ‰€ç¤ºã€‚</p><p>ä»£ç æ¸…å• 6: InstantSerializerBase å¯¹ ZonedDateTime å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–å’Œæ ¼å¼åŒ–çš„æ–¹æ³• InstantSerializerBase.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>protected</span><span style=color:#6e7681> </span>String<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>formatValue</span>(T<span style=color:#6e7681> </span>value,<span style=color:#6e7681> </span>SerializerProvider<span style=color:#6e7681> </span>provider)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>DateTimeFormatter<span style=color:#6e7681> </span>formatter<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>._formatter<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span><span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>?</span><span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>._formatter<span style=color:#6e7681> </span>:<span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>.defaultFormat;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(formatter<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(formatter.getZone()<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span><span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>&amp;&amp;</span><span style=color:#6e7681> </span>provider.getConfig().hasExplicitTimeZone()<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>&amp;&amp;</span><span style=color:#6e7681> </span>provider.isEnabled(SerializationFeature.WRITE_DATES_WITH_CONTEXT_TIME_ZONE))<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>formatter<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>formatter.withZone(provider.getTimeZone().toZoneId());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>formatter.format(value);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681> </span><span style=color:#ff7b72>else</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>value.toString();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>ä»ä»£ç æ¸…å•6å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæƒ³è¦å¯¹ ZonedDateTime å¯¹è±¡è¿›è¡Œæ ¼å¼åŒ–å’Œåºåˆ—åŒ–ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ€è·¯ï¼š</p><ul><li>æ€è·¯ä¸€ï¼šè®¾ç½® InstantSerializerBase çš„ defaultFormat å±æ€§æˆ–è€…å…¶çˆ¶ç±»ï¼ˆJSR310FormattedSerializerBaseï¼‰çš„ _formatter å±æ€§çš„ TimeZoneã€‚</li><li>æ€è·¯äºŒï¼šå¦‚æœ InstantSerializerBase çš„ defaultFormat å±æ€§æˆ–è€…å…¶çˆ¶ç±»çš„ _formatter å±æ€§æ²¡æœ‰è®¾ç½® TimeZoneï¼Œåˆ™éœ€è¦è®¾ç½® SerializerProvider çš„ TimeZoneã€‚</li></ul><h2 id=3-é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ>3 é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ
<a class=heading-link href=#3-%e9%97%ae%e9%a2%98%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><h3 id=31-åŸºäºæ€è·¯ä¸€çš„è§£å†³æ–¹æ¡ˆ>3.1 åŸºäºæ€è·¯ä¸€çš„è§£å†³æ–¹æ¡ˆ
<a class=heading-link href=#31-%e5%9f%ba%e4%ba%8e%e6%80%9d%e8%b7%af%e4%b8%80%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><h4 id=311-æ–¹æ³•ä¸€é€šè¿‡è‡ªå®šä¹‰çš„-jackson2objectmapperbuildercustomizer-è®¾ç½®-instantserializerbase-çš„-defaultformat-å±æ€§çš„-timezone>3.1.1 æ–¹æ³•ä¸€ï¼šé€šè¿‡è‡ªå®šä¹‰çš„ Jackson2ObjectMapperBuilderCustomizer è®¾ç½® InstantSerializerBase çš„ defaultFormat å±æ€§çš„ TimeZoneã€‚
<a class=heading-link href=#311-%e6%96%b9%e6%b3%95%e4%b8%80%e9%80%9a%e8%bf%87%e8%87%aa%e5%ae%9a%e4%b9%89%e7%9a%84-jackson2objectmapperbuildercustomizer-%e8%ae%be%e7%bd%ae-instantserializerbase-%e7%9a%84-defaultformat-%e5%b1%9e%e6%80%a7%e7%9a%84-timezone><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒJSR310FormattedSerializerBase çš„ _formatter å±æ€§çš„ä¼˜å…ˆçº§é«˜äº InstantSerializerBase çš„ defaultFormatã€‚JavaTimeModule åœ¨æ³¨å†Œ ZonedDateTimeSerializer æ—¶ï¼Œä½¿ç”¨å…¶æ— å‚æ„é€ æ–¹æ³•æ„é€ çš„ ZonedDateTimeSerializer å¯¹è±¡çš„ç¥–çˆ¶ JSR310FormattedSerializerBase çš„ _formatter å±æ€§ä¸º nullï¼Œå…¶çˆ¶ç±» InstantSerializerBase çš„ defaultFormat å±æ€§ï¼Œé»˜è®¤ä¸º DateTimeFormatter.ISO_OFFSET_DATE_TIMEã€‚DateTimeFormatter.ISO_OFFSET_DATE_TIME å±äºå¹¶æ²¡æœ‰æŒ‡å®š TimeZone çš„ DateTimeFormatter å¯¹è±¡ã€‚ä½†æ˜¯ ZonedDateTimeSerializer ç±»æä¾›äº†å…¬å¼€çš„æ„é€ æ–¹æ³• <code>public ZonedDateTimeSerializer(DateTimeFormatter formatter)</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ZonedDateTimeSerializer çš„æ„é€ æ–¹æ³•ï¼Œå¹¶æä¾›å·²æŒ‡å®šæ—¶åŒºçš„ DateTimeFormatterã€‚å¹¶ä¸”åŸºäº 2.1 è‡³ 2.4 çš„å…ˆéªŒçŸ¥è¯†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‘ ApplicationContext ä¸­æ³¨å…¥ä¸€ä¸ª Jackson2ObjectMapperBuilderCustomizerï¼Œæ¥å‘ Jackson2ObjectMapperBuilder ä¸­æ·»åŠ æŒ‡å®šäº† TimeZone çš„ DateTimeFormatter å¯¹è±¡çš„ ZonedDateTimeSerializerã€‚å¹¶ä¸”é€šè¿‡ Jackson2ObjectMapperBuilder è®¾ç½®çš„ ZonedDateTimeSerializer ä¼šè¦†ç›–é»˜è®¤çš„ JavaTimeModule ä¸­çš„ ZonedDateTimeSerializer å¯¹è±¡ï¼Œç¤ºä¾‹ä»£ç å¦‚ä»£ç æ¸…å•7æ‰€ç¤ºã€‚</p><p>ä»£ç æ¸…å• 7: é€šè¿‡è‡ªå®šä¹‰çš„ Jackson2ObjectMapperBuilderCustomizer è®¾ç½® InstantSerializerBase çš„ defaultFormat å±æ€§çš„ TimeZone ZonedDateTimeSerializerConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span>Jackson2ObjectMapperBuilderCustomizer<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>configureTimeZoneJackson2ObjectMapperBuilderCustomizer</span>()<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>DateTimeFormatter<span style=color:#6e7681> </span>dateTimeFormatterWithTimeZone<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>DateTimeFormatter.ofPattern(<span style=color:#a5d6ff>&#34;yyyy-MM-dd HH:mm:ssxxx&#34;</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>.withZone(ZoneId.of(<span style=color:#a5d6ff>&#34;Asia/Shanghai&#34;</span>));<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>builder<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-&gt;</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>       </span>builder.serializers(<span style=color:#ff7b72>new</span><span style=color:#6e7681> </span>ZonedDateTimeSerializer(dateTimeFormatterWithTimeZone));<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>};<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h4 id=312-æ–¹æ³•äºŒé€šè¿‡æºå¸¦-timezone-å±æ€§çš„-jsonformat-ä»è€Œè®¾ç½®-instantserializerbase-çš„çˆ¶ç±»jsr310formattedserializerbaseçš„-_formatter-å±æ€§çš„-timezone>3.1.2 æ–¹æ³•äºŒï¼šé€šè¿‡æºå¸¦ timezone å±æ€§çš„ @JsonFormat ä»è€Œè®¾ç½® InstantSerializerBase çš„çˆ¶ç±»ï¼ˆJSR310FormattedSerializerBaseï¼‰çš„ _formatter å±æ€§çš„ TimeZoneã€‚
<a class=heading-link href=#312-%e6%96%b9%e6%b3%95%e4%ba%8c%e9%80%9a%e8%bf%87%e6%90%ba%e5%b8%a6-timezone-%e5%b1%9e%e6%80%a7%e7%9a%84-jsonformat-%e4%bb%8e%e8%80%8c%e8%ae%be%e7%bd%ae-instantserializerbase-%e7%9a%84%e7%88%b6%e7%b1%bbjsr310formattedserializerbase%e7%9a%84-_formatter-%e5%b1%9e%e6%80%a7%e7%9a%84-timezone><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h4><p>å¦‚ä»£ç æ¸…å•8æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¡¨æ³¨æºå¸¦ timezone å±æ€§çš„ @JsonFormat åˆ°æŒ‡å®šçš„å­—æ®µä¸Šï¼Œæ¥è¾¾åˆ°è®¾ç½® InstantSerializerBase çš„çˆ¶ç±»ï¼ˆJSR310FormattedSerializerBaseï¼‰çš„ _formatter å±æ€§çš„ TimeZone çš„ç›®çš„ã€‚ä¸ºä»€ä¹ˆè¡¨æ³¨ @JsonFormatï¼Œå¯ä»¥è¾¾åˆ°è®¾ç½® InstantSerializerBase çš„çˆ¶ç±»ï¼ˆJSR310FormattedSerializerBaseï¼‰çš„ _formatter å±æ€§çš„ TimeZone çš„ç›®çš„ã€‚</p><p>ä»£ç æ¸…å• 8: é€šè¿‡æºå¸¦ timezone å±æ€§çš„ @JsonFormat ä»è€Œè®¾ç½® InstantSerializerBase çš„çˆ¶ç±»ï¼ˆJSR310FormattedSerializerBaseï¼‰çš„ _formatter å±æ€§çš„ TimeZone UserDto.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>UserDto</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>private</span><span style=color:#6e7681> </span>String<span style=color:#6e7681> </span>name;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>private</span><span style=color:#6e7681> </span>Integer<span style=color:#6e7681> </span>age;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@JsonFormat</span>(pattern<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;yyyy-MM-dd HH:mm:ss:ssXXX&#34;</span>,<span style=color:#6e7681> </span>timezone<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;GMT+8&#34;</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>private</span><span style=color:#6e7681> </span>ZonedDateTime<span style=color:#6e7681> </span>createdDateTime;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>é€šè¿‡ä»£ç æ¸…å•9ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ JSR310FormattedSerializerBase çš„ createContextual æ–¹æ³•ä¸­ï¼Œä¼šè·å– @JsonFormat çš„ä¿¡æ¯ï¼Œå¹¶æ ¹æ®å…¶ä¸­çš„ä¿¡æ¯è°ƒç”¨å…¶æŠ½è±¡æ–¹æ³• withFormat æ¥è®¾ç½® InstantSerializerBase çš„çˆ¶ç±»ï¼ˆJSR310FormattedSerializerBaseï¼‰çš„ _formatter å±æ€§ã€‚é€šè¿‡ä»£ç æ¸…å•10ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° JSR310FormattedSerializerBase çš„ useDateTimeFormatter æ–¹æ³•ä¼šæ ¹æ® @JsonFormat çš„ä¿¡æ¯ï¼Œæ„é€ ä¸€ä¸ª DateTimeFormatter å¯¹è±¡ã€‚
ä»£ç æ¸…å• 9: é€šè¿‡ @JsonFormat è®¾ç½® ZonedDateTimeSerializer çš„ _formatter å±æ€§çš„ä»£ç ç‰‡æ®µ JSR310FormattedSerializerBase.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span>JsonSerializer<span style=color:#ff7b72;font-weight:700>&lt;?&gt;</span><span style=color:#6e7681> </span>createContextual(SerializerProvider<span style=color:#6e7681> </span>prov,<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>BeanProperty<span style=color:#6e7681> </span>property)<span style=color:#6e7681> </span><span style=color:#ff7b72>throws</span><span style=color:#6e7681> </span>JsonMappingException<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>JsonFormat.Value<span style=color:#6e7681> </span>format<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>findFormatOverrides(prov,<span style=color:#6e7681> </span>property,<span style=color:#6e7681> </span>handledType());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(format<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>Boolean<span style=color:#6e7681> </span>useTimestamp<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>       </span><span style=color:#8b949e;font-style:italic>// Simple case first: serialize as numeric timestamp?</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>JsonFormat.Shape<span style=color:#6e7681> </span>shape<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>format.getShape();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(shape<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span>JsonFormat.Shape.ARRAY<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>||</span><span style=color:#6e7681> </span>shape.isNumeric()<span style=color:#6e7681> </span>)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>useTimestamp<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>Boolean.TRUE;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681> </span><span style=color:#ff7b72>else</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>useTimestamp<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>(shape<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span>JsonFormat.Shape.STRING)<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>?</span><span style=color:#6e7681> </span>Boolean.FALSE<span style=color:#6e7681> </span>:<span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>DateTimeFormatter<span style=color:#6e7681> </span>dtf<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>_formatter;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#8b949e;font-style:italic>// If not, do we have a pattern?</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(format.hasPattern())<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>dtf<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>_useDateTimeFormatter(prov,<span style=color:#6e7681> </span>format);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>JSR310FormattedSerializerBase<span style=color:#ff7b72;font-weight:700>&lt;?&gt;</span><span style=color:#6e7681> </span>ser<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>((shape<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span>_shape)<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>||</span><span style=color:#6e7681> </span>(useTimestamp<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span>_useTimestamp)<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>||</span><span style=color:#6e7681> </span>(dtf<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span>_formatter))<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>ser<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>ser.withFormat(useTimestamp,<span style=color:#6e7681> </span>dtf,<span style=color:#6e7681> </span>shape);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>Boolean<span style=color:#6e7681> </span>writeZoneId<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>format.getFeature(JsonFormat.Feature.WRITE_DATES_WITH_ZONE_ID);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>Boolean<span style=color:#6e7681> </span>writeNanoseconds<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>format.getFeature(JsonFormat.Feature.WRITE_DATE_TIMESTAMPS_AS_NANOSECONDS);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>((writeZoneId<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>)<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>||</span><span style=color:#6e7681> </span>(writeNanoseconds<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>!=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>))<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span>ser<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>ser.withFeatures(writeZoneId,<span style=color:#6e7681> </span>writeNanoseconds);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>ser;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span><span style=color:#ff7b72>this</span>;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>ä»£ç æ¸…å• 10: è§£æ @JsonFormat æ„é€  DateTimeFormatter çš„ _useDateTimeFormatter JSR310FormattedSerializerBase.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>protected</span><span style=color:#6e7681> </span>DateTimeFormatter<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>_useDateTimeFormatter</span>(SerializerProvider<span style=color:#6e7681> </span>prov,<span style=color:#6e7681> </span>JsonFormat.Value<span style=color:#6e7681> </span>format)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>DateTimeFormatter<span style=color:#6e7681> </span>dtf;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>final</span><span style=color:#6e7681> </span>String<span style=color:#6e7681> </span>pattern<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>format.getPattern();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>final</span><span style=color:#6e7681> </span>Locale<span style=color:#6e7681> </span>locale<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>format.hasLocale()<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>?</span><span style=color:#6e7681> </span>format.getLocale()<span style=color:#6e7681> </span>:<span style=color:#6e7681> </span>prov.getLocale();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(locale<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span><span style=color:#79c0ff>null</span>)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>dtf<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>DateTimeFormatter.ofPattern(pattern);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681> </span><span style=color:#ff7b72>else</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>dtf<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>DateTimeFormatter.ofPattern(pattern,<span style=color:#6e7681> </span>locale);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic>//Issue #69: For instant serializers/deserializers we need to configure the formatter with</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic>//a time zone picked up from JsonFormat annotation, otherwise serialization might not work</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>if</span><span style=color:#6e7681> </span>(format.hasTimeZone())<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>dtf<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>dtf.withZone(format.getTimeZone().toZoneId());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>dtf;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=32-åŸºäºæ€è·¯äºŒçš„è§£å†³æ–¹æ¡ˆ>3.2 åŸºäºæ€è·¯äºŒçš„è§£å†³æ–¹æ¡ˆ
<a class=heading-link href=#32-%e5%9f%ba%e4%ba%8e%e6%80%9d%e8%b7%af%e4%ba%8c%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>é€šè¿‡è°ƒè¯•å’Œä»£ç åˆ†æï¼Œæˆ‘ä»¬å¯çŸ¥ SerializerProvider çš„ TimeZone æ¥è‡ªäº ObjectMapper çš„ TimeZoneï¼Œå› æ­¤ä»…ä»…éœ€è¦è®¾ç½® ObjectMapper çš„ TimeZone å³å¯ã€‚æœ‰å¤šç§æ–¹å¼å¯ä»¥è®¾ç½® ObjectMapper çš„ TimeZoneã€‚</p><h4 id=321-æ–¹æ³•ä¸€é€šè¿‡-spring-boot-common-application-properties-ä¸­çš„-springjacksontime-zone-é…ç½®-objectmapper-çš„-timezone>3.2.1 æ–¹æ³•ä¸€ï¼šé€šè¿‡ Spring Boot Common Application Properties ä¸­çš„ spring.jackson.time-zone é…ç½® ObjectMapper çš„ TimeZone
<a class=heading-link href=#321-%e6%96%b9%e6%b3%95%e4%b8%80%e9%80%9a%e8%bf%87-spring-boot-common-application-properties-%e4%b8%ad%e7%9a%84-springjacksontime-zone-%e9%85%8d%e7%bd%ae-objectmapper-%e7%9a%84-timezone><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h4><p>æˆ‘ä»¬å¯ä»¥åœ¨ Spring Boot çš„ <a href=https://docs.spring.io/spring-boot/appendix/application-properties/index.html class=external-link target=_blank rel=noopener>Common Application Properties</a> ä¸­æ‰¾åˆ°é…ç½® ObjectMapper çš„ TimeZone çš„å±æ€§ï¼šspring.jackson.time-zoneï¼Œå…¶å‚æ•°çš„æ ¼å¼ä¸ºï¼Œ&ldquo;America/Los_Angeles&rdquo; or &ldquo;GMT+10&rdquo;, å¦‚ä»£ç æ¸…å•11 æ‰€ç¤ºã€‚
ä»£ç æ¸…å• 11: è®¾ç½® ObjectMapper çš„ TimeZone çš„å±æ€§ application.yaml</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>spring</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>jackson</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>time-zone</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Asia/Shanghai</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>ä¸ºå•¥é…ç½®äº†è¯¥å±æ€§ï¼Œå°±èƒ½é…ç½® ObjectMapper çš„ TimeZoneï¼Ÿå› ä¸º Spring Boot é…ç½®äº†ä¸€ä¸ª StandardJackson2ObjectMapperBuilderCustomizerï¼Œè¯¥ StandardJackson2ObjectMapperBuilderCustomizer ä¼šè¯»å– spring.jackson.time-zone çš„å€¼ï¼Œå¹¶è®¾ç½® Jackson2ObjectMapperBuilder çš„ TimeZoneï¼Œå¦‚ä»£ç æ¸…å• 5æ‰€ç¤ºã€‚Jackson2ObjectMapperBuilder åœ¨æ„å»º ObjectMapper æ—¶ï¼Œä¼šæ ¹æ®å…¶ä¸­çš„ TimeZoneï¼Œè®¾ç½® ObjectMapper çš„ TimeZoneã€‚</p><h4 id=322-æ–¹æ³•äºŒé€šè¿‡è‡ªå®šä¹‰çš„-jackson2objectmapperbuildercustomizer-é…ç½®-objectmapper-çš„-timezone>3.2.2 æ–¹æ³•äºŒï¼šé€šè¿‡è‡ªå®šä¹‰çš„ Jackson2ObjectMapperBuilderCustomizer é…ç½® ObjectMapper çš„ TimeZone
<a class=heading-link href=#322-%e6%96%b9%e6%b3%95%e4%ba%8c%e9%80%9a%e8%bf%87%e8%87%aa%e5%ae%9a%e4%b9%89%e7%9a%84-jackson2objectmapperbuildercustomizer-%e9%85%8d%e7%bd%ae-objectmapper-%e7%9a%84-timezone><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h4><p>é€šè¿‡ä»£ç æ¸…å•4ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼ŒJacksonObjectMapperBuilderConfiguration åœ¨æ„å»º Jackson2ObjectMapperBuilder æ—¶ï¼Œä¼šä» ApplicationContext ä¸­è·å–æ‰€æœ‰ Jackson2ObjectMapperBuilderCustomizer ç±»å‹çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ä»–ä»¬ customize å¯¹ Jackson2ObjectMapperBuilder è¿›è¡Œè‡ªå®šä¹‰ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å‘ ApplicationContext ä¸­æ³¨å…¥ä¸€ä¸ª Jackson2ObjectMapperBuilderCustomizerï¼Œæ¥è®¾ç½® Jackson2ObjectMapperBuilder çš„ TimeZoneï¼Œè¿›è€Œè¾¾åˆ°è®¾ç½® ObjectMapper çš„ TimeZone çš„ç›®çš„ï¼Œå…¶ç¤ºä¾‹ä»£ç å¦‚ä»£ç æ¸…å•12æ‰€ç¤ºã€‚</p><p>ä»£ç æ¸…å• 12: é€šè¿‡è‡ªå®šä¹‰çš„ Jackson2ObjectMapperBuilderCustomizer è®¾ç½® ObjectMapper çš„ TimeZone ZonedDateTimeSerializerConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span>Jackson2ObjectMapperBuilderCustomizer<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>configureTimeZoneJackson2ObjectMapperBuilderCustomizer</span>()<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>builder<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-&gt;</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>builder.timeZone(TimeZone.getTimeZone(<span style=color:#a5d6ff>&#34;Asia/Shanghai&#34;</span>));<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>};<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=4-è§£å†³èƒŒæ™¯ä¸­å¼•å…¥çš„é—®é¢˜>4 è§£å†³èƒŒæ™¯ä¸­å¼•å…¥çš„é—®é¢˜
<a class=heading-link href=#4-%e8%a7%a3%e5%86%b3%e8%83%8c%e6%99%af%e4%b8%ad%e5%bc%95%e5%85%a5%e7%9a%84%e9%97%ae%e9%a2%98><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>å›åˆ°èƒŒæ™¯ä¸­æè¿°çš„é—®é¢˜æœ¬èº«ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°äº†å¯¼è‡´èƒŒæ™¯ä¸­æè¿°é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚å› ä¸ºå…¶ç”Ÿäº§ä»£ç é€šè¿‡è‡ªå®šä¹‰çš„ Jackson2ObjectMapperBuilderCustomizer è®¾ç½® ObjectMapper çš„ TimeZone ä¸º <code>TimeZone.getDefault()</code>ï¼Œå¦‚ä»£ç æ¸…å•13æ‰€ç¤ºã€‚<code>TimeZone.getDefault()</code> ä¼šæ ¹æ®è·å– JVM é»˜è®¤çš„ TimeZoneã€‚ä¾‹å¦‚åœ¨åº”ç”¨åœ¨ Sydney è¯¥å€¼ä¸º <code>Australia/Sydney</code>ï¼›åº”ç”¨åœ¨ä¸­å›½ï¼Œè¯¥å€¼ä¸º <code>Asia/Shanghai</code>ã€‚è¿™å°±è§£é‡Šäº†èƒŒæ™¯ä¸­æè¿°çš„ç°è±¡ã€‚æœ€åæˆ‘ä»¬æ ¹æ®ä¸šåŠ¡å®é™…çš„è¦æ±‚ï¼Œå°†è¯¥ ObjectMapper çš„ TimeZone ä¸ºå›ºå®šè®¾ç½®ä¸º <code>Australia/Sydney</code>ï¼Œæœ€ç»ˆè§£å†³äº†è¯¥é—®é¢˜ã€‚
ä»£ç æ¸…å• 13: é€šè¿‡è‡ªå®šä¹‰çš„ Jackson2ObjectMapperBuilderCustomizer è®¾ç½® ObjectMapper çš„ TimeZone ä¸º TimeZone.getDefault() ZonedDateTimeSerializerConfiguration.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@Bean</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span>Jackson2ObjectMapperBuilderCustomizer<span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>configureTimeZoneJackson2ObjectMapperBuilderCustomizer</span>()<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>return</span><span style=color:#6e7681> </span>builder<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-&gt;</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>builder.timeZone(TimeZone.getDefault());<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>};<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id=5-reference>5 Reference
<a class=heading-link href=#5-reference><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><ul><li><a href=https://www.baeldung.com/spring-boot-customize-jackson-objectmapper class=external-link target=_blank rel=noopener>Spring Boot: Customize the Jackson ObjectMapper</a></li><li><a href=https://www.herodotus.vip/guide/design/jackson.html class=external-link target=_blank rel=noopener>Jackson é…ç½®ä¸æ‰©å±•</a></li><li><a href=https://www.jianshu.com/p/1031c09da1db class=external-link target=_blank rel=noopener>@JsonFormat å®ç°åŸç†</a></li></ul></div><div style="text-align:center;color:#a9a9a9;width:50%;margin:0 auto"><p>æœ¬ä½œå“é‡‡ç”¨<a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ style=color:#a9a9a9>çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯</p></div><div style="border-bottom-style:dashed;border-bottom-style:inset;border-bottom-width:2px;width:50%;margin:0 auto"></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme");getTheme=getTheme??"light";let s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","csmervyn/csmervyn.github.io"),s.setAttribute("data-repo-id","R_kgDOGbYn4A"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOGbYn4M4CWQYR"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-term",""),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",getTheme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading",""),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container>Â©
2019 -
2025
Mervyn
Â·
æŠ€æœ¯æ”¯æŒ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>