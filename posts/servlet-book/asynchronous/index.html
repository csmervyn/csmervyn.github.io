<!doctype html><html lang=zh-cn><head><title>ç¬¬ä¸ƒç«  å¼‚æ­¥å¤„ç†ã€éƒ¨åˆ†ã€‘ Â· å¢¨å®¢äººç”Ÿ</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Mervyn"><meta name=description content="æœ¬ç« å°†ä»‹ç» Servlet API 3.0 å¼•å…¥çš„å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚å¼‚æ­¥å¤„ç†æ˜¯ä¸ºäº†å‡å°‘åŒæ­¥å¤„ç†ä¸­ä¼šå‡ºç°çš„é˜»å¡å’Œç­‰å¾…é—®é¢˜ï¼Œå¯¹ç³»ç»Ÿååç‡ç­‰å½±å“ã€‚é€šè¿‡å¼‚æ­¥å¤„ç†å¯ä»¥å……åˆ†åˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚æœ¬ç« å°†ä»å°è¯•å›ç­”å¼‚æ­¥å¤„ç†å°è¯•è§£å†³çš„é—®é¢˜å¼€å§‹ï¼Œé€æ­¥ä»‹ç» Servlet API å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒå’Œå¼‚æ­¥å¤„ç†çš„å…¸å‹é¡ºåºã€‚ç´§æ¥ç€é€šè¿‡å…·ä½“çš„ç¤ºä¾‹æ¼”ç¤ºå¼‚æ­¥å¤„ç†çš„è¿‡ç¨‹ï¼Œè®©è¯»è€…å¯¹ Servlet çš„å¼‚æ­¥å¤„ç†æœ‰ä¸€ä¸ªç›´è§‚çš„è®¤è¯†å¹¶ä½“ä¼šå…¶ä¼˜åŠ¿ã€‚æœ€åä¹Ÿä¼šé˜è¿°å¼‚æ­¥å¤„ç†å…·ä½“çš„é€‚ç”¨åœºæ™¯ã€‚é€šè¿‡å­¦ä¹ æœ¬ç« ï¼Œæ‚¨å°†èƒ½å¤Ÿäº†è§£ Servlet å¼‚æ­¥å¤„ç†çš„åŸºæœ¬æ¦‚å¿µå’Œå®ç°æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å…¶æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="ç¬¬ä¸ƒç«  å¼‚æ­¥å¤„ç†ã€éƒ¨åˆ†ã€‘"><meta name=twitter:description content="æœ¬ç« å°†ä»‹ç» Servlet API 3.0 å¼•å…¥çš„å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚å¼‚æ­¥å¤„ç†æ˜¯ä¸ºäº†å‡å°‘åŒæ­¥å¤„ç†ä¸­ä¼šå‡ºç°çš„é˜»å¡å’Œç­‰å¾…é—®é¢˜ï¼Œå¯¹ç³»ç»Ÿååç‡ç­‰å½±å“ã€‚é€šè¿‡å¼‚æ­¥å¤„ç†å¯ä»¥å……åˆ†åˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚æœ¬ç« å°†ä»å°è¯•å›ç­”å¼‚æ­¥å¤„ç†å°è¯•è§£å†³çš„é—®é¢˜å¼€å§‹ï¼Œé€æ­¥ä»‹ç» Servlet API å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒå’Œå¼‚æ­¥å¤„ç†çš„å…¸å‹é¡ºåºã€‚ç´§æ¥ç€é€šè¿‡å…·ä½“çš„ç¤ºä¾‹æ¼”ç¤ºå¼‚æ­¥å¤„ç†çš„è¿‡ç¨‹ï¼Œè®©è¯»è€…å¯¹ Servlet çš„å¼‚æ­¥å¤„ç†æœ‰ä¸€ä¸ªç›´è§‚çš„è®¤è¯†å¹¶ä½“ä¼šå…¶ä¼˜åŠ¿ã€‚æœ€åä¹Ÿä¼šé˜è¿°å¼‚æ­¥å¤„ç†å…·ä½“çš„é€‚ç”¨åœºæ™¯ã€‚é€šè¿‡å­¦ä¹ æœ¬ç« ï¼Œæ‚¨å°†èƒ½å¤Ÿäº†è§£ Servlet å¼‚æ­¥å¤„ç†çš„åŸºæœ¬æ¦‚å¿µå’Œå®ç°æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å…¶æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚"><meta property="og:url" content="http://example.org/posts/servlet-book/asynchronous/"><meta property="og:site_name" content="å¢¨å®¢äººç”Ÿ"><meta property="og:title" content="ç¬¬ä¸ƒç«  å¼‚æ­¥å¤„ç†ã€éƒ¨åˆ†ã€‘"><meta property="og:description" content="æœ¬ç« å°†ä»‹ç» Servlet API 3.0 å¼•å…¥çš„å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚å¼‚æ­¥å¤„ç†æ˜¯ä¸ºäº†å‡å°‘åŒæ­¥å¤„ç†ä¸­ä¼šå‡ºç°çš„é˜»å¡å’Œç­‰å¾…é—®é¢˜ï¼Œå¯¹ç³»ç»Ÿååç‡ç­‰å½±å“ã€‚é€šè¿‡å¼‚æ­¥å¤„ç†å¯ä»¥å……åˆ†åˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚æœ¬ç« å°†ä»å°è¯•å›ç­”å¼‚æ­¥å¤„ç†å°è¯•è§£å†³çš„é—®é¢˜å¼€å§‹ï¼Œé€æ­¥ä»‹ç» Servlet API å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒå’Œå¼‚æ­¥å¤„ç†çš„å…¸å‹é¡ºåºã€‚ç´§æ¥ç€é€šè¿‡å…·ä½“çš„ç¤ºä¾‹æ¼”ç¤ºå¼‚æ­¥å¤„ç†çš„è¿‡ç¨‹ï¼Œè®©è¯»è€…å¯¹ Servlet çš„å¼‚æ­¥å¤„ç†æœ‰ä¸€ä¸ªç›´è§‚çš„è®¤è¯†å¹¶ä½“ä¼šå…¶ä¼˜åŠ¿ã€‚æœ€åä¹Ÿä¼šé˜è¿°å¼‚æ­¥å¤„ç†å…·ä½“çš„é€‚ç”¨åœºæ™¯ã€‚é€šè¿‡å­¦ä¹ æœ¬ç« ï¼Œæ‚¨å°†èƒ½å¤Ÿäº†è§£ Servlet å¼‚æ­¥å¤„ç†çš„åŸºæœ¬æ¦‚å¿µå’Œå®ç°æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å…¶æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-09T20:46:04+07:00"><meta property="article:modified_time" content="2025-02-09T20:46:04+07:00"><link rel=canonical href=http://example.org/posts/servlet-book/asynchronous/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.60f552a2c0452fcc0254c54f21c3e0728460c1ae85f97a9c35833a222ef8b884.css integrity="sha256-YPVSosBFL8wCVMVPIcPgcoRgwa6F+XqcNYM6Ii74uIQ=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://example.org/>å¢¨å®¢äººç”Ÿ
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/life/>ç”Ÿæ´»</a></li><li class=navigation-item><a class=navigation-link href=/posts/>åšå®¢</a></li><li class=navigation-item><a class=navigation-link href=/about-me>å…³äºæˆ‘</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://example.org/posts/servlet-book/asynchronous/>ç¬¬ä¸ƒç«  å¼‚æ­¥å¤„ç†ã€éƒ¨åˆ†ã€‘</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2025-02-09T20:46:04+07:00>February 9, 2025
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
é˜…è¯»æ—¶é—´ï¼š7 åˆ†é’Ÿ
</span><span class=post-word-count>| ğŸ‰ 3225 å­—</span></div><div class=authors><i class="fa-solid fa-user" aria-hidden=true></i>
<a href=/authors/mervyn/>Mervyn</a></div></div></header><div class=post-content><p>æœ¬ç« å°†ä»‹ç» Servlet API 3.0 å¼•å…¥çš„å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚å¼‚æ­¥å¤„ç†æ˜¯ä¸ºäº†å‡å°‘åŒæ­¥å¤„ç†ä¸­ä¼šå‡ºç°çš„é˜»å¡å’Œç­‰å¾…é—®é¢˜ï¼Œå¯¹ç³»ç»Ÿååç‡ç­‰å½±å“ã€‚é€šè¿‡å¼‚æ­¥å¤„ç†å¯ä»¥å……åˆ†åˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚æœ¬ç« å°†ä»å°è¯•å›ç­”å¼‚æ­¥å¤„ç†å°è¯•è§£å†³çš„é—®é¢˜å¼€å§‹ï¼Œé€æ­¥ä»‹ç» Servlet API å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒå’Œå¼‚æ­¥å¤„ç†çš„å…¸å‹é¡ºåºã€‚ç´§æ¥ç€é€šè¿‡å…·ä½“çš„ç¤ºä¾‹æ¼”ç¤ºå¼‚æ­¥å¤„ç†çš„è¿‡ç¨‹ï¼Œè®©è¯»è€…å¯¹ Servlet çš„å¼‚æ­¥å¤„ç†æœ‰ä¸€ä¸ªç›´è§‚çš„è®¤è¯†å¹¶ä½“ä¼šå…¶ä¼˜åŠ¿ã€‚æœ€åä¹Ÿä¼šé˜è¿°å¼‚æ­¥å¤„ç†å…·ä½“çš„é€‚ç”¨åœºæ™¯ã€‚é€šè¿‡å­¦ä¹ æœ¬ç« ï¼Œæ‚¨å°†èƒ½å¤Ÿäº†è§£ Servlet å¼‚æ­¥å¤„ç†çš„åŸºæœ¬æ¦‚å¿µå’Œå®ç°æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å…¶æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><h2 id=71-å¼‚æ­¥å¤„ç†å°è¯•è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆ>7.1 å¼‚æ­¥å¤„ç†å°è¯•è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ
<a class=heading-link href=#71-%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e5%b0%9d%e8%af%95%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98%e6%98%af%e4%bb%80%e4%b9%88><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>è¿‡æ»¤å™¨æˆ– Servlet åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œå­˜åœ¨ä¸€äº›åœºæ™¯éœ€è¦ä¾èµ–æŸäº›èµ„æºæˆ–ç­‰å¾…æŸä¸ªäº‹ä»¶ã€‚åœ¨è¿™äº›èµ„æºæˆ–äº‹ä»¶æ²¡æœ‰å°±ç»ªçš„æƒ…å†µä¸‹ï¼Œä»–ä»¬æ— æ³•å®Œæˆè¯·æ±‚çš„å¤„ç†ã€‚ä¾‹å¦‚ï¼Œåœ¨ç”Ÿæˆå“åº”ä¹‹å‰ï¼ŒServlet å¯èƒ½éœ€è¦ç­‰å¾…å¯ç”¨çš„ JDBC è¿æ¥ã€ç­‰å¾…IOæ“ä½œã€æ¥è‡ªè¿œç¨‹ Web æœåŠ¡çš„å“åº”ã€JMS æ¶ˆæ¯æˆ–åº”ç”¨ç¨‹åºäº‹ä»¶ç­‰ã€‚å¦‚æœåœ¨åŒæ­¥å¤„ç†æ¨¡å¼ä¸‹ï¼Œé€šå¸¸éœ€è¦åœ¨è¿‡æ»¤å™¨æˆ– Servlet ä¸­ç­‰å¾…ã€‚åœ¨è¿‡æ»¤å™¨æˆ– Servlet ä¸­ç­‰å¾…æ˜¯ä¸€ç§ä½æ•ˆæ–¹å¼ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ç§æ¶ˆè€—çº¿ç¨‹å’Œå…¶ä»–æœ‰é™èµ„æºçš„é˜»å¡æ“ä½œã€‚é€šå¸¸ï¼Œä¸€ä¸ªç¼“æ…¢çš„èµ„æºï¼ˆå¦‚æ•°æ®åº“ï¼‰å¯èƒ½æœ‰è®¸å¤š Servlet å®¹å™¨çš„çº¿ç¨‹é˜»å¡ç­‰å¾…è®¿é—®ï¼Œå¹¶å¯èƒ½å¯¼è‡´çº¿ç¨‹é¥¥é¥¿å’Œæ•´ä¸ª Web å®¹å™¨çš„æœåŠ¡è´¨é‡ä½ä¸‹ã€‚è€Œä½¿ç”¨å¼‚æ­¥å¤„ç†çš„æ–¹å¼ï¼Œåˆ™å¯ä»¥å°†é˜»å¡æ“ä½œäº¤ç”±å¦ä¸€ä¸ªä¸šåŠ¡çº¿ç¨‹æˆ–ä¸šåŠ¡çº¿ç¨‹æ± å¤„ç†ï¼ŒåŸæœ¬å®¹å™¨å¤„ç†è¯·æ±‚çš„å·¥ä½œçº¿ç¨‹å¯ä»¥åœ¨ä¸æäº¤å“åº”çš„æƒ…å†µä¸‹ç«‹å³è¿”å›çº¿ç¨‹æ± ï¼Œå»å¤„ç†å…¶å®ƒçš„è¯·æ±‚æˆ–ä»»åŠ¡ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿçš„ååé‡å’Œå¹¶å‘èƒ½åŠ›ã€‚ç¬”è€…è®¤ä¸ºè¿™å°±æ˜¯å¼‚æ­¥å¤„ç†åœ¨å°è¯•è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€‚æ­¤å¤–ï¼Œå¼‚æ­¥å¤„ç†è¿˜å¯ä»¥åˆ©ç”¨å¹¶è¡Œï¼Œå‡å°‘å®¢æˆ·ç«¯çš„ç­‰å¾…æ—¶é—´ï¼Œæé«˜ç³»ç»Ÿçš„å“åº”é€Ÿåº¦ï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒã€‚</p><h2 id=72-servlet-api-30-å¯¹å¼‚æ­¥çš„æ”¯æŒ>7.2 Servlet API 3.0 å¯¹å¼‚æ­¥çš„æ”¯æŒ
<a class=heading-link href=#72-servlet-api-30-%e5%af%b9%e5%bc%82%e6%ad%a5%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>ä¸ºäº†æ”¯æŒå¼‚æ­¥æ“ä½œï¼ŒServlet API ä» 3.0 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†ä¸€äº›æ–°çš„æ”¹å˜ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li>ä½¿ Servlet å’Œè¿‡æ»¤å™¨å¯ä»¥é…ç½®æ˜¯å¦å¼€å¯å¯¹å¼‚æ­¥æ“ä½œçš„æ”¯æŒã€‚</li><li>AsyncContext æ¥å£ï¼šè¿™ä¸ªæ¥å£æ˜¯æ”¯æŒ Servlet å¼‚æ­¥æ“ä½œçš„æ ¸å¿ƒæ¥å£ã€‚é€šè¿‡è¯¥æ¥å£ Servlet å¯ä»¥åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªå¯¹è±¡æ¥è¿›è¡Œå¼‚æ­¥æ“ä½œçš„ç®¡ç†ã€‚</li><li>åœ¨ ServletRequest ç±»ä¸­å¢åŠ äº†çš„æ”¯æŒå¼‚æ­¥çš„ç›¸å…³æ–¹æ³•ã€‚</li><li>AsyncEvent ç±»å’Œ AsyncListener æ¥å£ï¼Œä½œä¸ºå¼‚æ­¥äº‹ä»¶ç±»å’Œå¼‚æ­¥äº‹ä»¶ç›‘å¬å™¨ã€‚</li></ol><p>ä¸Šé¢è¿™äº›ä¸€èµ·æ„æˆäº† Servlet API ä¸­å¼‚æ­¥æ“ä½œçš„å®Œæ•´æœºåˆ¶ï¼Œæ–¹ä¾¿å¼€å‘è€…è¿›è¡Œå¼‚æ­¥æ“ä½œçš„ç¼–å†™å’Œç®¡ç†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹å®ƒä»¬è¿›è¡Œç®€å•çš„ä»‹ç»ã€‚</p><h2 id=721-servlet-å¦‚ä½•å¼€å¯å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>7.2.1 Servlet å¦‚ä½•å¼€å¯å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#721-servlet-%e5%a6%82%e4%bd%95%e5%bc%80%e5%90%af%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>åœ¨ 2.7 èŠ‚ä¸­æˆ‘ä»¬äº†è§£äº†é…ç½® Servlet çš„ä¸‰ç§æ–¹å¼ï¼Œå› æ­¤ Servlet ä¹Ÿæ”¯æŒè¿™ä¸‰ç§æ–¹å¼å¼€å¯å¼‚æ­¥å¤„ç†ã€‚</p><h3 id=1åœ¨-webxml-ä¸­å¼€å¯-servlet-å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>1)ã€åœ¨ web.xml ä¸­å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#1%e5%9c%a8-webxml-%e4%b8%ad%e5%bc%80%e5%90%af-servlet-%e5%af%b9%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>ä» 2.7.1 èŠ‚çš„è¡¨ 2.1 ä¸­ï¼Œæˆ‘ä»¬è·çŸ¥äº† web.xml é‡Œé¢<code>&lt;servlet></code> å…ƒç´ ä¸­çš„<code>&lt;async-supported></code> å…ƒç´ çš„ä½œç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>&lt;async-supported></code> å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ å¯¹äºçš„å€¼è®¾ç½®æˆ trueï¼Œä»è€Œè¡¨ç¤ºç›¸åº”çš„ Servlet å¼€å¯äº†å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚å¦‚æœåœ¨ <code>&lt;servlet></code> å…ƒç´ ä¸­ä¸å®šä¹‰ <code>&lt;async-supported></code> å…ƒç´ ï¼Œåˆ™è¯¥å…ƒç´ æ‰€å¯¹åº”çš„é»˜è®¤å€¼ä¸º falseã€‚<code>&lt;async-supported></code> å…ƒç´ çš„å€¼ä¸º false, åˆ™è¡¨æ˜è¯¥ Servlet ä¸æ”¯æŒå¼‚æ­¥å¤„ç†ã€‚</p><p>å¦‚ä»£ç æ¸…å• 7.1 æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ web.xml ä¸­é…ç½® <code>&lt;servlet></code> å…ƒç´ ï¼Œå¹¶ä¸”åœ¨è¯¥å…ƒç´ ä¸­é…ç½® <code>&lt;async-supported></code> å…ƒç´ ï¼Œå°†å…¶å€¼è®¾ç½®ä¸º trueï¼Œä»è€Œè¡¨ç¤º AsynchronousServlet å¼€å¯äº†å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚</p><p>ä»£ç æ¸…å•7.1 åœ¨ web.xml ä¸­å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼šweb.xml</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#7ee787>&lt;web-app</span> xmlns=<span style=color:#a5d6ff>&#34;https://jakarta.ee/xml/ns/jakartaee&#34;</span>
</span></span><span style=display:flex><span>         xmlns:xsi=<span style=color:#a5d6ff>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>         xsi:schemaLocation=<span style=color:#a5d6ff>&#34;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd&#34;</span>
</span></span><span style=display:flex><span>         version=<span style=color:#a5d6ff>&#34;6.0&#34;</span><span style=color:#7ee787>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;servlet-name&gt;</span>asynchronous-servlet<span style=color:#7ee787>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;servlet-class&gt;</span>com.mervyn.learn.servlet.AsynchronousServlet<span style=color:#7ee787>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;async-supported&gt;</span>true<span style=color:#7ee787>&lt;/async-supported&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;servlet-name&gt;</span>asynchronous-servlet<span style=color:#7ee787>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;url-pattern&gt;</span>/asynchronous<span style=color:#7ee787>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;/servlet-mapping&gt;</span>
</span></span><span style=display:flex><span><span style=color:#7ee787>&lt;/web-app&gt;</span>
</span></span></code></pre></div><h3 id=2ä½¿ç”¨æ³¨è§£æ–¹å¼å¼€å¯-servlet-å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>2)ã€ä½¿ç”¨æ³¨è§£æ–¹å¼å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#2%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e6%96%b9%e5%bc%8f%e5%bc%80%e5%90%af-servlet-%e5%af%b9%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>ä» 2.7.2 èŠ‚çš„è¡¨ 2.2 ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†é€šè¿‡ <code>@WebServlet</code> çš„ asyncSupported å±æ€§ï¼Œå¯ä»¥å¼€å¯æˆ–å…³é—­ Servlet å¯¹å¼‚æ­¥çš„æ”¯æŒã€‚å¦‚æœå°†è¯¥å±æ€§çš„å€¼è®¾ç½®ä¸º trueï¼Œåˆ™è¡¨æ˜æ ‡æ³¨æ­¤ <code>@WebServlet</code> çš„ Servlet å¼€å¯äº†å¯¹å¼‚æ­¥çš„æ”¯æŒã€‚å¦‚æœä¸è®¾ç½®è¯¥å±æ€§çš„å€¼æˆ–å°†è¯¥å±æ€§æŒ‡å®šä¸º falseï¼Œåˆ™è¡¨æ˜æ ‡æ³¨æ­¤ <code>@WebServlet</code> çš„ Servlet ä¸æ”¯æŒå¼‚æ­¥ã€‚</p><p>ä»£ç æ¸…å•7.2 ä½¿ç”¨æ³¨è§£æ–¹å¼å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒä»£ç ç‰‡æ®µï¼šAsynchronousServlet.java</p><p>å¦‚ä»£ç æ¸…å• 7.2 æ‰€ç¤ºï¼Œæˆ‘ä»¬å°† <code>@WebServlet</code> æ³¨è§£çš„ asyncSupported å±æ€§ï¼Œå°†å…¶å€¼è®¾ç½®ä¸º trueï¼Œä»è€Œè¡¨ç¤º AsynchronousServlet å¼€å¯äº†å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@WebServlet</span>(value<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;/asynchronous&#34;</span>,<span style=color:#6e7681> </span>asyncSupported<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>true</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>AsynchronousServlet</span><span style=color:#6e7681> </span><span style=color:#ff7b72>extends</span><span style=color:#6e7681> </span>HttpServlet<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic>// ...</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=3é€šè¿‡ç¼–ç¨‹æ–¹å¼å¼€å¯-servlet-å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>3)ã€é€šè¿‡ç¼–ç¨‹æ–¹å¼å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#3%e9%80%9a%e8%bf%87%e7%bc%96%e7%a8%8b%e6%96%b9%e5%bc%8f%e5%bc%80%e5%90%af-servlet-%e5%af%b9%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>ä» 2.7.3 èŠ‚çš„è¡¨ 2.3 ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°é€šè¿‡ ServletRegistration.Dynamic çš„ <code>setAsyncSupported(boolean isAsyncSupported)</code> çš„æ–¹æ³•å¯ä»¥å¼€å¯æˆ–å…³é—­ Servlet å¯¹å¼‚æ­¥çš„æ”¯æŒã€‚å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•æ—¶ä½¿ç”¨çš„ isAsyncSupported å‚æ•°çš„å€¼ä¸º trueï¼Œåˆ™ç›¸åº”çš„ Servlet å¼€å¯äº†å¯¹å¼‚æ­¥çš„æ”¯æŒã€‚å¦‚æœä¸è°ƒç”¨è¯¥æ–¹æ³•æˆ–ä½¿ç”¨ false ä½œä¸ºå‚æ•°è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™è¡¨æ˜ç›¸åº”çš„ Servlet ä¸æ”¯æŒå¼‚æ­¥ã€‚</p><p>å¦‚ä»£ç æ¸…å• 7.3 æ‰€ç¤ºï¼Œæˆ‘ä»¬å°† true ä½œä¸ºå‚æ•°è°ƒç”¨ ServletRegistration.Dynamic çš„ setAsyncSupported æ–¹æ³•ï¼Œä»è€Œè¡¨ç¤º AsynchronousServlet å¼€å¯äº†å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒã€‚</p><p>ä»£ç æ¸…å•7.3 é€šè¿‡ç¼–ç¨‹æ–¹å¼å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒä»£ç ç‰‡æ®µ CustomServletContextListener.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@WebListener</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>CustomServletContextListener</span><span style=color:#6e7681> </span><span style=color:#ff7b72>implements</span><span style=color:#6e7681> </span>ServletContextListener<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Override</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>void</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>contextInitialized</span>(ServletContextEvent<span style=color:#6e7681> </span>servletContextEvent)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>ServletContext<span style=color:#6e7681> </span>servletContext<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>servletContextEvent.getServletContext();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>ServletRegistration.Dynamic<span style=color:#6e7681> </span>asynchronousServletRegistration<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>servletContext.addServlet(<span style=color:#a5d6ff>&#34;asynchronousServlet&#34;</span>,<span style=color:#6e7681> </span>AsynchronousServlet.class);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>asynchronousServletRegistration.addMapping(<span style=color:#a5d6ff>&#34;/asynchronous&#34;</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>asynchronousServletRegistration.setAsyncSupported(<span style=color:#79c0ff>true</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºé€šè¿‡ä¸Šè¿°å“ªç§æ–¹æ³•å¼€å¯ Servlet å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œè¿™ä»…ä»…è¡¨æ˜æŒ‡å®šçš„ Servlet å¯ä»¥æˆ–èƒ½å¤Ÿæ”¯æŒå¼‚æ­¥å¤„ç†ã€‚å¦‚æœéœ€è¦å¼€å¯ä¸€ä¸ªå¼‚æ­¥å¤„ç†ï¼Œè¿˜éœ€è¦è°ƒç”¨ ServletRequest æ¥å£ä¸­çš„ <code>startAsync()</code> æˆ– <code>startAsync(ServletRequest servletRequest, ServletResponse servletResponse)</code> æ–¹æ³•ã€‚è¿™æ ·å®¹å™¨å¹¶ä¸ä¼šæäº¤å“åº”ï¼ŒåŒæ—¶åŸå§‹çº¿ç¨‹ä¹Ÿä¼šé€€å‡º Servlet å¹¶è¿”å›çº¿ç¨‹æ± ã€‚åœ¨å¼‚æ­¥å¤„ç†æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œç›´åˆ°è°ƒç”¨ AsyncContext ä¸Šçš„ <code>complete()</code> æ–¹æ³•ä»¥åï¼Œå®¹å™¨æ‰ä¼šæäº¤å“åº”ã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®¹å™¨é€šè¿‡è°ƒç”¨ startAsync æ–¹æ³•å‘èµ·çš„åˆ†æ´¾è¿”å›ä¹‹å‰ï¼Œå¦‚æœå¼‚æ­¥ä»»åŠ¡å·²ç»å¼€å§‹æ‰§è¡Œï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºå°±éœ€è¦è´Ÿè´£å¤„ç†è¯·æ±‚å’Œå“åº”å¯¹è±¡çš„å¹¶å‘è®¿é—®ã€‚</p><p>å¦‚æœ Servlet ä»…æ˜¯å¼€å¯äº†å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œè¯·æ±‚è¿‡æ»¤å™¨å’Œ Servlet æ²¡æœ‰è°ƒç”¨ä»»ä½•çš„ <code>startAsync</code> æ–¹æ³•ï¼Œé‚£ä¹ˆå®¹å™¨ä¼šå°†è¯¥ Servlet æŒ‰ç…§åŒæ­¥çš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚å¦‚æœåœ¨ Servlet ä¸­æ²¡æœ‰å¼€å¯å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œä½†å´å°è¯•è°ƒç”¨ä»»ä½•çš„ startAsync æ–¹æ³•ï¼Œé‚£ä¹ˆå®¹å™¨ä¼šæŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚å½“ç„¶æˆ‘ä»¬éœ€è¦åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­é¿å…è¿™ç§å……æ»¡æ­§ä¹‰çš„æƒ…å†µï¼Œè®© Servlet çš„å¤„ç†æ¨¡å¼ä¸å…¶è¡Œä¸ºä¿æŒä¸€è‡´ã€‚</p><h2 id=722-è¿‡æ»¤å™¨å¦‚ä½•å¼€å¯å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>7.2.2 è¿‡æ»¤å™¨å¦‚ä½•å¼€å¯å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#722-%e8%bf%87%e6%bb%a4%e5%99%a8%e5%a6%82%e4%bd%95%e5%bc%80%e5%90%af%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h2><p>åœ¨ 6.6 èŠ‚ä¸­æˆ‘ä»¬äº†è§£äº†é…ç½®è¿‡æ»¤å™¨çš„ä¸‰ç§æ–¹å¼ï¼Œå› æ­¤è¿‡æ»¤å™¨éœ€è¦å¼€å¯å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œä¹Ÿæ”¯æŒè¿™ä¸‰æ–¹æ–¹å¼ã€‚</p><h3 id=1åœ¨-webxml-ä¸­å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>1)ã€åœ¨ web.xml ä¸­å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#1%e5%9c%a8-webxml-%e4%b8%ad%e5%bc%80%e5%90%af%e8%bf%87%e6%bb%a4%e5%99%a8%e5%af%b9%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>é€šè¿‡ 6.6.1 èŠ‚çš„è¡¨ 6-1 æˆ‘ä»¬äº†è§£åˆ°ï¼Œå¯ä»¥é€šè¿‡ <code>&lt;filter></code> å…ƒç´ ä¸­çš„<code>&lt;async-supported></code> å…ƒç´ æ¥è®¾ç½®è¿‡æ»¤å™¨æ˜¯å¦æ”¯æŒå¼‚æ­¥æ“ä½œã€‚å¦‚æœè¿‡æ»¤å™¨æ”¯æŒå¼‚æ­¥æ“ä½œï¼Œéœ€è¦å°†è¯¥ <code>&lt;async-supported></code> å…ƒç´ çš„å€¼è®¾ç½®æˆ trueã€‚å¦‚æœå°†è¯¥å…ƒç´ çš„å€¼è®¾ç½® falseï¼Œåˆ™æ„å‘³ç€è¿‡æ»¤å™¨ä¸æ”¯æŒå¼‚æ­¥æ“ä½œã€‚å¦‚æœ<code>&lt;filter></code> å…ƒç´ ä¸­æ²¡æœ‰å£°æ˜ <code>&lt;async-supported></code> å…ƒç´ ï¼Œé‚£ä¹ˆé»˜è®¤å€¼ä¸º falseã€‚</p><p>å¦‚ä»£ç æ¸…å•7.4 æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨ web.xml ä¸­é…ç½®äº†ä¸€ä¸ªåä¸º asynchronousFilter è¿‡æ»¤å™¨ï¼Œé€šè¿‡å°† <code>&lt;async-supported></code> å…ƒç´ çš„å€¼è®¾ç½®æˆ trueï¼Œè¡¨æ˜è¯¥è¿‡æ»¤å™¨æ”¯æŒå¼‚æ­¥æ“ä½œã€‚</p><p>ä»£ç æ¸…å•7.4 åœ¨ web.xml ä¸­å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼šweb.xml</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#7ee787>&lt;web-app</span> xmlns=<span style=color:#a5d6ff>&#34;https://jakarta.ee/xml/ns/jakartaee&#34;</span>
</span></span><span style=display:flex><span>         xmlns:xsi=<span style=color:#a5d6ff>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>         xsi:schemaLocation=<span style=color:#a5d6ff>&#34;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd&#34;</span>
</span></span><span style=display:flex><span>         version=<span style=color:#a5d6ff>&#34;6.0&#34;</span><span style=color:#7ee787>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;filter&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;filter-name&gt;</span>asynchronousFilter<span style=color:#7ee787>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;filter-class&gt;</span>com.mervyn.learn.servlet.AsynchronousFilter<span style=color:#7ee787>&lt;/filter-class&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;async-supported&gt;</span>true<span style=color:#7ee787>&lt;/async-supported&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;/filter&gt;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;filter-mapping&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;filter-name&gt;</span>asynchronousFilter<span style=color:#7ee787>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&lt;url-pattern&gt;</span>/asynchronous<span style=color:#7ee787>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&lt;/filter-mapping&gt;</span>
</span></span><span style=display:flex><span><span style=color:#7ee787>&lt;/web-app&gt;</span>
</span></span></code></pre></div><h3 id=2ä½¿ç”¨æ³¨è§£æ–¹å¼å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>2)ã€ä½¿ç”¨æ³¨è§£æ–¹å¼å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#2%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e6%96%b9%e5%bc%8f%e5%bc%80%e5%90%af%e8%bf%87%e6%bb%a4%e5%99%a8%e5%af%b9%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>é€šè¿‡ 6.6.2 èŠ‚çš„è¡¨ 6-2 @WebFilter å±æ€§è¯´æ˜ï¼Œæˆ‘ä»¬äº†è§£åˆ°å¯ä»¥é€šè¿‡è¯¥æ³¨è§£çš„ asyncSupported å±æ€§ï¼Œæ¥è®¾ç½®è¿‡æ»¤å™¨æ˜¯å¦æ”¯æŒå¼‚æ­¥æ“ä½œã€‚å¦‚æœè¿‡æ»¤å™¨æ”¯æŒå¼‚æ­¥æ“ä½œï¼Œéœ€è¦å°† @WebFilter ä¸­çš„ asyncSupported å±æ€§çš„å€¼è®¾ç½®æˆ trueã€‚å¦‚æœè¯¥è¯¥å±æ€§çš„å€¼è®¾ç½®ä¸º false, åˆ™æ„å‘³ç€è¿‡æ»¤å™¨ä¸æ”¯æŒå¼‚æ­¥æ“ä½œã€‚å¦‚æœ @WebFilter ä¸­ä¸å£°æ˜ asyncSupported å±æ€§ï¼Œåˆ™ asyncSupported çš„å€¼é»˜ä¸º falseã€‚å…³äº asyncSupported å±æ€§çš„é…ç½®ï¼Œå¯å‚è€ƒä»£ç æ¸…å•7.5ã€‚</p><p>ä»£ç æ¸…å•7.5 ä½¿ç”¨æ³¨è§£æ–¹å¼å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒä»£ç ç‰‡æ®µï¼šAsynchronousFilter.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@WebFilter</span>(urlPatterns<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>{<span style=color:#a5d6ff>&#34;/asynchronous&#34;</span>},<span style=color:#6e7681> </span>asyncSupported<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#79c0ff>true</span>)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>AsynchronousFilter</span><span style=color:#6e7681> </span><span style=color:#ff7b72>extends</span><span style=color:#6e7681> </span>HttpFilter<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic>// ......</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h3 id=3é€šè¿‡ç¼–ç¨‹æ–¹å¼å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ>3)ã€é€šè¿‡ç¼–ç¨‹æ–¹å¼å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒ
<a class=heading-link href=#3%e9%80%9a%e8%bf%87%e7%bc%96%e7%a8%8b%e6%96%b9%e5%bc%8f%e5%bc%80%e5%90%af%e8%bf%87%e6%bb%a4%e5%99%a8%e5%af%b9%e5%bc%82%e6%ad%a5%e5%a4%84%e7%90%86%e7%9a%84%e6%94%af%e6%8c%81><i class="fa-solid fa-link" aria-hidden=true title=é“¾æ¥åˆ°æ ‡é¢˜></i>
<span class=sr-only>é“¾æ¥åˆ°æ ‡é¢˜</span></a></h3><p>é€šè¿‡ 4.4.3 èŠ‚ï¼Œæˆ‘ä»¬äº†è§£å¦‚ä½•ä»¥ç¼–ç¨‹æ–¹å¼æ·»åŠ å’Œé…ç½®è¿‡æ»¤å™¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ true ä½œä¸ºå‚æ•°å€¼ï¼Œè°ƒç”¨ FilterRegistration.Dynamic çš„ setAsyncSupported æ–¹æ³•ï¼Œç”¨æ¥è®¾ç½®è¿‡æ»¤å™¨æ˜¯æ”¯æŒå¼‚æ­¥æ“ä½œçš„ã€‚å¦‚æœä½¿ç”¨ false ä½œä¸ºå‚æ•°å€¼è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæˆ–è€…é…ç½®è¿‡æ»¤å™¨çš„è¿‡ç¨‹ä¸­ä¸è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™è¡¨ç¤ºè¿‡æ»¤å™¨ä¸æ”¯æŒå¼‚æ­¥æ“ä½œã€‚</p><p>å¦‚ä»£ç æ¸…å•7.6æ‰€ç¤ºï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ FilterRegistration.Dynamic çš„ setAsyncSupported æ–¹æ³•ï¼Œå°†è®¾ç½® asynchronousFilter ä¸ºæ”¯æŒå¼‚æ­¥æ“ä½œã€‚</p><p>ä»£ç æ¸…å•7.6 é€šè¿‡ç¼–ç¨‹æ–¹å¼å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒä»£ç ç‰‡æ®µï¼šCustomServletContextListener.java</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@WebListener</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>CustomServletContextListener</span><span style=color:#6e7681> </span><span style=color:#ff7b72>implements</span><span style=color:#6e7681> </span>ServletContextListener<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#d2a8ff;font-weight:700>@Override</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>void</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>contextInitialized</span>(ServletContextEvent<span style=color:#6e7681> </span>servletContextEvent)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>ServletContext<span style=color:#6e7681> </span>servletContext<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>servletContextEvent.getServletContext();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>FilterRegistration.Dynamic<span style=color:#6e7681> </span>asynchronousFilterRegistration<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>                </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>servletContext.addFilter(<span style=color:#a5d6ff>&#34;asynchronousFilter&#34;</span>,<span style=color:#6e7681> </span>AsynchronousFilter.class);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>asynchronousFilterRegistration.addMappingForUrlPatterns(EnumSet.of(DispatcherType.REQUEST),<span style=color:#6e7681> </span><span style=color:#79c0ff>true</span>,<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;/asynchronous&#34;</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>asynchronousFilterRegistration.setAsyncSupported(<span style=color:#79c0ff>true</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>ä¸ Servlet å¼€å¯å¼‚æ­¥å¤„ç†çš„æ”¯æŒä¸€æ ·ï¼Œæ— è®ºé€šè¿‡ä¸Šè¿°å“ªç§æ–¹æ³•å¼€å¯è¿‡æ»¤å™¨å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œè¿™ä»…ä»…è¡¨æ˜æŒ‡å®šçš„è¿‡æ»¤å™¨å¯ä»¥æˆ–èƒ½å¤Ÿæ”¯æŒå¼‚æ­¥å¤„ç†ã€‚å¦‚æœéœ€è¦å¼€å¯ä¸€ä¸ªå¼‚æ­¥å¤„ç†ï¼Œè¿˜éœ€è¦è°ƒç”¨ ServletRequest æ¥å£ä¸­çš„ <code>startAsync()</code> æˆ– <code>startAsync(ServletRequest servletRequest, ServletResponse servletResponse)</code> æ–¹æ³•ï¼Œå°†è¯·æ±‚ç½®äºå¼‚æ­¥æ¨¡å¼ã€‚</p><p>å¦‚æœè¿‡æ»¤å™¨ä»…æ˜¯å¼€å¯äº†å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œè€Œè¿‡æ»¤å™¨æˆ– Servlet æ²¡æœ‰è°ƒç”¨ä»»ä½•çš„ startAsync æ–¹æ³•ï¼Œé‚£ä¹ˆå®¹å™¨ä¼šå°†è¯¥è¿‡æ»¤å™¨æŒ‰ç…§åŒæ­¥çš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªå¼€å¯çš„å¼‚æ­¥å¤„ç†çš„è¿‡æ»¤å™¨å³å¯ä»¥å¤„ç†å¼‚æ­¥è¯·æ±‚ä¹Ÿå¯ä»¥å¤„ç†åŒæ­¥è¯·æ±‚ã€‚å¦‚æœåœ¨è¿‡æ»¤å™¨ä¸­æ²¡æœ‰å¼€å¯å¯¹å¼‚æ­¥å¤„ç†çš„æ”¯æŒï¼Œä½†å´å°è¯•åœ¨è¿‡æ»¤å™¨æˆ– Servlet ä¸­è°ƒç”¨ä»»ä½•çš„ startAsync æ–¹æ³•ï¼Œé‚£ä¹ˆå®¹å™¨éƒ½ä¼šæŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚</p></div><div style="text-align:center;color:#a9a9a9;width:50%;margin:0 auto"><p>æœ¬ä½œå“é‡‡ç”¨<a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ style=color:#a9a9a9>çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯</p></div><div style="border-bottom-style:dashed;border-bottom-style:inset;border-bottom-width:2px;width:50%;margin:0 auto"></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme");getTheme=getTheme??"light";let s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","csmervyn/csmervyn.github.io"),s.setAttribute("data-repo-id","R_kgDOGbYn4A"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOGbYn4M4CWQYR"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-term",""),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",getTheme),s.setAttribute("data-lang","zh-CN"),s.setAttribute("data-loading",""),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container>Â©
2019 -
2025
Mervyn
Â·
æŠ€æœ¯æ”¯æŒ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>